name: Windows CryptoAPI Spoofing Vulnerability (CVE-2020-0601 - CurveBall) 
description: |
  'A spoofing vulnerability exists in the way Windows CryptoAPI (Crypt32.dll) validates Elliptic Curve Cryptography (ECC) certificates. An attacker could exploit the vulnerability by using a spoofed code-signing certificate to sign a malicious executable, making it appear the file was from a trusted, legitimate source.'
severity: low
enabled: false
requiredDataConnectors:
  - connectorId: Events
    dataTypes:
      - Event
queryFrequency: 5m
queryPeriod: 5m
suppressionDuration: 5m
triggerOperator: gt
triggerThreshold: 0
incidentConfiguration:
  createIncident: true
  groupingConfiguration: 
    enabled: True
    reopenClosedIncident: False
    lookbackDuration: 5h
    entitiesMatchingMethod: all
    groupByEntities:
tactics:
  - DefenseEvasion
relevantTechniques:
  - T1116
query: |
  Event | where EventLog == "Application" and Message contains "[CVE-2020-0601]"   
  | extend HostCustomEntity = Computer
  | extend AccountCustomEntity = UserName